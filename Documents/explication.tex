\documentclass[12pt,oneside]{article}

\AddToHook{cmd/section/before}{\clearpage}

% usepackage
\usepackage[margin=1in]{geometry}
\usepackage{amssymb,amsmath,amsthm}
\usepackage{titlesec}
\usepackage[hidelinks]{hyperref}
\usepackage{mathtools}

% This removes page numbers.
\pagenumbering{gobble}

% Make the space between lines slightly more
% generous than normal single spacing, but compensate
% so that the spacing between rows of matrices still
% looks normal.  Note that 1.1=1/.9090909...
\renewcommand{\baselinestretch}{1.1}
\renewcommand{\arraystretch}{.91}

% Define an environment for exercises.
\newenvironment{exercise}[1]{\begin{minipage}{\linewidth}\vspace{1cm}\stepcounter{exo}\noindent\textbf{Exercice \thesection.\theexo \ - #1} \hspace{.05em} \vspace{0.5cm}\newline}{\end{minipage}}

%Création d'un compteur pour les exercices
\newcounter{exo}[section]

% Allow for underlining.
\usepackage[normalem]{ulem}

%displaystyle by default
\everymath{\displaystyle}

\titlespacing{\section}{0pt}{5.5ex plus 1ex minus .2ex}{4.3ex plus .2ex}

% define shortcut commands for commonly used symbols
\newcommand{\R}{\mathbb{R}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\K}{\mathbb{K}}
\newcommand{\calP}{\mathcal{P}}
\newcommand{\MnR}{\mathcal{M}_n(\R)}
\newcommand{\MnC}{\mathcal{M}_n(\C)}
\newcommand{\sh}{\text{sh}}
\newcommand{\ch}{\text{ch}}
\newcommand{\Tr}{\text{Tr}}
\newcommand{\Vect}{\text{Vect}}

\DeclareMathOperator{\vsspan}{span}

\title{Exercices de colle - MPSI}
\author{Camille DUBOIS}
\date{2021-2022}

\renewcommand*\contentsname{Chapitres}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

\maketitle

\tableofcontents

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\textbf{Calcul des latitudes/longitudes maximales à considérer pour améliorer la complexité de résolution}

Rappelons que la distance entre deux points $A$ et $B$ de l'espace en coordonnées latitude/longitude s'écrit : $d_{AB} = R_T \arccos ( \sin \Phi_A \sin \Phi_B + \cos \Phi_A \cos \Phi_B d \lambda)$, avec $\lambda = \lambda_A - \lambda_B$.

Ainsi, pour avoir un arrêt assez proche du point considéré, il faut en particulier qu'il soit aussi proche si les latitudes étaient égales et si les longitudes étaient égales. Ces considitions se traduisent au premier ordre - approximation justifiée par la distance de marche tolérée - par :
\begin{itemize}
    \item \textit{latitudes égales : } en faisant l'approximation des petits angles ($d \Phi << 1$), il vient naturellement comme condition : $|\Phi^{rad}_{stop} - \Phi^{rad}_{XY}| \leq d_{marche}/R_T$. D'où : $|\Phi_{stop} - \Phi_{XY}| \leq 180 d_{marche}/\pi R_T$.
    \item \textit{longitudes égales : } on développe la formule sus-citée avec $\Phi_A = \Phi_B$ et $d\lambda << 1$. On obtient : $d_{stop, XY} \approx \sqrt{\cos \Phi} |d\lambda^{rad}|$. D'où : $d_{stop, XY} \approx \pi \sqrt{\cos \Phi} |d\lambda|/180$
\end{itemize}

En triant la liste des arrêts (complexité $n \log n, \quad n = \text{nombre d'arrêts}$) par latitude croissante, on peut éliminer deux extrémités de la liste (qui ne vérifieraient pas la condition sur les latitudes) puis en triant la liste restante par longitude croissante on peut éliminer l'autre moitié de la liste (qui ne vérifieraient pas la condition sur les longitudes). Chaque étape "d'élimination" s'effectue par dichotomie (complexité $\log n$). Il reste ensuite à vérifier que les points restants ne sont pas seulement dans le carré de côté $d_{marche}$ centré en $(X, Y)$ mais qu'ils sont bien dans le cercle, ce qui est peu coûteux en complexité comparé au reste.

Finalement, on passe d'une complexité en $O(n^2)$ à une complexité en $O(n \log n)$. Ceci se ressent dans les performances puisque l'on traite des données de l'ordre de $10^4$ arrêts.

\end{document}